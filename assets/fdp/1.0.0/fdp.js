define("fdp/1.0.0/fdp-form",["$","cellula/0.4.2/cellula","cellula/0.4.2/cellula-namespace","cellula/0.4.2/cellula-class","cellula/0.4.2/cellula-util","cellula/0.4.2/cellula-events","cellula/0.4.2/cellula-cell","cellula/0.4.2/cellula-element","cellula/0.4.2/cellula-collection","./fdp-namespace"],function(a,b,c){var d=a("$"),e=a("cellula/0.4.2/cellula"),f=a("./fdp-namespace"),g=f.FormItem,h=e._util,i=e.Class,j=(e.Element,e.Cell),k=e.Collection,l=f.Form=new i("Form",{type:void 0,validateAll:!1,submitBtn:null,collection:null,itemList:void 0,tableView:void 0,paging:void 0,init:function(a){this.key||(this.key=this.__cid__),this._super(a),this._bindAll("search","doSearch","dataDispatch","submit"),this.collection=new k({type:g}),this.rootNode&&(this.submitBtn=d("input[type=submit]",this.rootNode)),this.paging&&(this.follow(this.paging),this.paging.follow(this),this.tableView&&this.paging.follow(this.tableView),this.tableView&&this.tableView.follow(this.paging),this.tableView&&this.tableView.follow(this)),this.createItem(),this.registerEvents()},registerEvents:function(){d(this.rootNode).submit("single"==this.type?this.submit:this.doSearch)},createItem:function(){h.each(this.itemList,function(a){this.register("FORMITEM:VALIDATE",a),this.collection.push(a)},this)},submit:function(a){a.preventDefault(),this.validate(),this.validateAll&&console.log(this.getData())},validate:function(){return this.emit("FORMITEM:VALIDATE"),h.each(this.collection.get(),function(a){return this.validateAll=a.validate,a.validate?void 0:"break"},this,"break"),this.validateAll},disable:function(){},getData:function(){var a={};return h.each(this.collection.get(),function(b){a=h.mix(a,b.getData())},this),a},receiver:function(a){if(a){var b=(a.target,a.name.split(":")[1]);switch(b){case"SETPAGEDEFAULT":this.pageDefault=arguments[1];break;case"SETPAGECOLLECTION":this.pageCollection=arguments[1];break;case"DOSEARCH":this.doSearch(arguments[1])}}},doSearch:function(a){var b,c,d,e,f,g,i=!1;a&&a.preventDefault&&(a.preventDefault(),i=!0),(i||!i&&!a)&&this.validate()?(this.emit("PAGINATOR:GETDEFAULTPAGE"),this.emit("PAGINATOR:GETCOLLECTION"),b=this.pageDefault,c=this.pageCollection,d=c.get("size"),f=d.get(),e=h.values(f)[0],g=h.mix(this.getData(),h.isEmpty(e)?b.size:e,b.number||{})):!i&&a&&this.validate()&&(g=h.mix({},this.getData(),a)),g&&this.search(g)},customSearch:function(){},search:function(a){this.customSearch.call(this,a)},dataDispatch:function(a){return a.queryForm&&a.result&&a.result.paging?(this.emit("TABLE:TABLERENDER",a.result.detail),void this.emit("PAGINATOR:PAGINGRENDER",a.result.paging)):void console.log("data stuct error!")}}).inherits(j);c.exports=l}),define("fdp/1.0.0/fdp-formItem",["./fdp-namespace","cellula/0.4.2/cellula","cellula/0.4.2/cellula-namespace","cellula/0.4.2/cellula-class","cellula/0.4.2/cellula-util","cellula/0.4.2/cellula-events","cellula/0.4.2/cellula-cell","cellula/0.4.2/cellula-element","cellula/0.4.2/cellula-collection","$"],function(a,b,c){var d=a("./fdp-namespace"),e=a("cellula/0.4.2/cellula"),f=a("$"),g=e._util,h=e.Class,i=(e.Element,e.Cell),j=(e.Collection,["INPUT","SELECT","RADIO","CHECKBOX","TEXTAREA"]),k=d.FormItem=new h("FormItem",{type:"input",require:!0,validate:!1,hideClass:"fn-hide",errorClass:"mi-form-item-error",errorMessage:void 0,tipClass:"mi-form-explain",label:void 0,tip:void 0,element:void 0,tipElement:void 0,name:void 0,value:void 0,beforeValidate:void 0,afterValidate:void 0,init:function(a){if(this._super(a),this.key=this.key?this.key:this.__cid__,this.type=this.type.toUpperCase(),this.allowItemType())throw new Error("formItem type is error!");this.setElement(),this._bindAll("focus","blur"),this.bindDefaultEvent()},revalidate:function(a){this.triggerValidate(a)},allowItemType:function(){return-1==f.inArray(this.type,j)},setElement:function(){var a,b=[],c=this.rootNode&&g.getElementsByClassName(this.tipClass,this.rootNode)[0];if("INPUT"==this.type||"TEXTAREA"==this.type||"SELECT"==this.type)if(this.element=this.rootNode&&this.rootNode.getElementsByTagName(this.type),1==this.element.length)this.element=this.element[0],this.name=this.element&&this.element.name;else{for(a=0,len=this.element.length;a<len;a++)b.push({ele:this.element[a],name:this.element[a].name,value:this.element[a].value});this.element=b}("RADIO"==this.type||"CHECKBOX"==this.type)&&(this.element=f("[type="+this.type+"]",this.rootNode),this.name=this.element&&this.element[0].name),c&&(this.tipElement=c,this.tip=this.tipElement.innerHTML)},getData:function(){var a,b,c,d,e={},f={};if(g.isArray(this.element))for(a=0,b=this.element.length;b>a;a++)c=this.element[a].name,d=this.element[a].value,e[c]=d,g.mix(f,e);else f[this.name]=this.value;return f},save:function(a){var b,c,d=[];if(a===!0)if(this.validate=!0,"INPUT"==this.type||"TEXTAREA"==this.type)if(g.isArray(this.element))for(b=0,c=this.element.length;c>b;b++)this.element[b].value=g.trim(this.element[b].ele.value);else this.value=this.element&&g.trim(this.element.value);else if("SELECT"==this.type)this.value=this.element&&this.element.options[this.element.selectedIndex].value;else if("RADIO"==this.type){for(b=0,c=this.element.length;c>b;b++)if(this.element[b].checked){this.value=this.element[b].value;break}}else if("CHECKBOX"==this.type){for(b=0,c=this.element.length;c>b;b++)this.element[b].checked&&d.push(this.element[b].value);this.value=d.join(",")}else try{this.value=this.element&&g.trim(this.element.value)}catch(e){throw new Error("formItem type is error!")}else this.validate=!1},bindDefaultEvent:function(){("INPUT"==this.type||"TEXTAREA"==this.type)&&(f(this.element).blur(this.blur),f(this.element).focus(this.focus))},setDefaultTip:function(){this.tipElement.innerHTML=this.tip,g.removeClass(this.tipElement.parentNode,this.errorClass)},isEmpty:function(a){return g.isEmpty(a)},rule:{},rollback:function(){var a=!0;return g.isObject(this.rule)&&g.each(this.rule,function(b){return g.isFunction(b)&&!b.call(this)?(a=!1,"break"):void 0},this,"break"),a},triggerValidate:function(){var a,b,c,d,e,f=!1;if(this.beforeValidate&&g.isFunction(this.beforeValidate)&&this.beforeValidate.apply(this,arguments),this.require){if("INPUT"==this.type||"TEXTAREA"==this.type||"SELECT"==this.type)if(c="SELECT"==this.type?"请选择":"请填写",g.isArray(this.element)){for(a=0,d=this.element.length;d>a;a++)if(this.isEmpty(this.element[a].ele.value))return this.save(!1),this.errorMessage=c+this.label,this.error(),!1}else if(c="FILE"==this.element.type.toUpperCase()?"请选择":c,e=this.element.value,this.isEmpty(e))return this.save(!1),this.errorMessage=c+this.label,this.error(),!1;if(("RADIO"==this.type||"CHECKBOX"==this.type)&&(g.each(this.element,function(a){return a.checked?(f=!0,"break"):void 0},this,"break"),!f))return this.save(!1),this.errorMessage="请选择"+this.label,this.error(),!1;if(b=this.rollback(),!b)return this.save(!1),this.error(),!1}else if("INPUT"==this.type||"TEXTAREA"==this.type)if(g.isArray(this.element)){for(a=0,d=this.element.length;d>a;a++)if(!this.isEmpty(this.element[a].ele.value)&&(b=this.rollback(),!b))return this.save(!1),this.error(),!1}else if(e=this.element.value,!this.isEmpty(e)&&(b=this.rollback(),!b))return this.save(!1),this.error(),!1;this.save(!0),this.setDefaultTip(),this.afterValidate&&g.isFunction(this.afterValidate)&&this.afterValidate.apply(this,arguments)},error:function(){this.tipElement&&!this.validate&&(this.tipElement.innerHTML=this.errorMessage||window.console&&console.log("errorMessage is null.")||"",g.addClass(this.tipElement.parentNode,this.errorClass))},focus:function(){this.setDefaultTip()},blur:function(a){this.triggerValidate(a)},receiver:function(a){if(a){var b=(a.target,a.name.split(":")[1]);switch(b){case"VALIDATE":this.revalidate(a)}}}}).inherits(i);c.exports=k}),define("fdp/1.0.0/fdp-namespace",[],function(a,b,c){var d={};d.version="1.0.0",d.Form=void 0,d.FormItem=void 0,d.Paginator=void 0,d.DataTable=void 0,c.exports=d}),define("fdp/1.0.0/fdp-paginator",["./fdp-namespace","cellula/0.4.2/cellula","cellula/0.4.2/cellula-namespace","cellula/0.4.2/cellula-class","cellula/0.4.2/cellula-util","cellula/0.4.2/cellula-events","cellula/0.4.2/cellula-cell","cellula/0.4.2/cellula-element","cellula/0.4.2/cellula-collection","$","select/1.0.0/select"],function(a,b,c){var d=a("./fdp-namespace"),e=a("cellula/0.4.2/cellula"),f=a("$"),g=a("select/1.0.0/select"),h=e._util,i=e.Class,j=e.Element,k=e.Cell,l=e.Collection,m=new i("SizeElement",{value:void 0,save:function(){return this.set(new Function("return {size : {sizeDefault:"+this.value+"}}").call(this))},init:function(a){this._super(a),this.set({size:{sizeDefault:20}})}}).inherits(j),n=new i("NumberElement",{value:void 0,save:function(){return this.set(new Function("return {number : {currentPage:"+this.value+"}}").call(this))},init:function(a){this._super(a),this.set({number:{currentPage:1}})}}).inherits(j),o=new i("PageElement",{save:function(){console.log("save page element data")},items:{},options:{},init:function(a){this._super(a),this.set({sizePerPage:20,totalItems:null,current:1})}}).inherits(j),p=d.Paginator=new i("Paginator",{hideClass:"fn-hide",sizeSelect:void 0,collection:void 0,pageDefault:{size:{sizeDefault:20},number:{currentPage:1},page:{first:1,last:null,prev:null,next:null,totalItems:null,totalPages:null,current:null,currentArray:null},sizeDefault:20,sizeOptions:[10,20,50]},pageTpl:'<span class="mi-paging-info fn-ml15">每页</span><select name="size" id="J_size">$-{#options}<option $-{#selected}selected $-{/selected} value="$-{num}">$-{num}</option>$-{/options}</select><span class="mi-paging-info mi-paging-which"><input type="text" id="J_number" name="number" value="$-{current}"></span><a href="javascript:;" class="mi-paging-item mi-paging-goto"><span class="paging-text">跳转</span></a><span class="mi-paging-info fn-ml15"><span class="paging-text mi-paging-bold">$-{current}/$-{totalPages}</span>页</span>$-{#pre}<a href="javascript:;" class="mi-paging-item mi-paging-prev fn-mr10"><span class="paging-text">上一页</span><span class="mi-paging-icon"></span></a>$-{/pre}$-{#preDis}<span class="mi-paging-item mi-paging-prev mi-paging-prev-disabled fn-mr10"><span class="paging-text">上一页</span><span class="mi-paging-icon"></span></span>$-{/preDis}$-{#next}<a href="javascript:;" class="mi-paging-item mi-paging-next"><span class="paging-text">下一页</span><span class="mi-paging-icon"></span></a>$-{/next}$-{#nextDis}<span class="mi-paging-item mi-paging-next mi-paging-next-disabled"><span class="paging-text">下一页</span><span class="mi-paging-icon"></span></span>$-{/nextDis}',typeEnum:{first:"\\bfirst\\b",last:"\\blast\\b",prev:"\\bprev\\b",next:"\\bnext\\b","goto":"\\bgoto\\b"},init:function(a){this._super(a),this._bindAll("changeSize","paginate"),this.collection=new l,this.collection.push(new m({key:"size"})),this.collection.push(new n({key:"number"})),this.collection.push(new o({key:"page"}))},receiver:function(a){if(a){var b=(a.target,a.name.split(":")[1]);switch(b){case"PAGINGRENDER":this.render(arguments[1]);break;case"GETDEFAULTPAGE":this.getDefault();break;case"GETCOLLECTION":this.getCollection();break;case"SYSTEMERROR":h.addClass(this.rootNode,this.hideClass);break;case"NORESULT":h.addClass(this.rootNode,this.hideClass)}}},getDefault:function(){this.emit("FORM:SETPAGEDEFAULT",this.pageDefault)},getCollection:function(){this.emit("FORM:SETPAGECOLLECTION",this.collection)},getOperationType:function(a){for(var b in this.typeEnum)if(new RegExp(this.typeEnum[b]).test(a))return b},calcNumber:function(a){var b=this.getOperationType(a.className),c=this.collection.get("page"),d=parseInt(c.get("current")),e=parseInt(c.get("totalPages"));return void 0===b?/(\D*)(\d+)(\D*)/.exec(a.innerHTML)?/(\D*)(\d+)(\D*)/.exec(a.innerHTML)[2]:void 0:"last"===b?e:"prev"===b?d-1>1?d-1:1:"next"===b?e>d+1?d+1:e:1},operate:function(a){var b=this.collection.get("number"),c=this.calcNumber(a);return b&&c?b.set(h.keys(b.get())[0],c):!1},paginate:function(a){a&&a.preventDefault&&a.preventDefault();var b=this.collection;if("goto"===this.getOperationType(a.currentTarget.className)){var c=this.pageDefault,d=f("input[name=number]",this.rootNode),e=b.get("size"),g=h.values(e.get())[0],i=b.get("number");isNaN(parseInt(d.val()))||parseInt(d.val())<1?(d.val(h.values(c.number)[0]),i.value=h.values(c.number)[0]):i.value=d.val(),i.save(),h.isEmpty(g)&&e.set({size:this.pageDefault.size}),this.emit("FORM:DOSEARCH",h.mix({},h.values(e.get())[0],h.values(i.get())[0]))}else if(this.operate(a.currentTarget)){var e=b.get("size"),g=h.values(e.get())[0],i=b.get("number");h.isEmpty(g)&&e.set(this.pageDefault.size),this.emit("FORM:DOSEARCH",h.mix({},h.values(e.get())[0],h.values(i.get())[0]))}},changeSize:function(){var a=this.collection.get("size");a.value=this.sizeSelect.getValue(),a.save(),this.emit("FORM:DOSEARCH",h.mix({},h.values(a.get())[0],this.pageDefault.number||{}))},prepareTplConfig:function(a){var b=this.collection.get("page");a&&b.set(a);var c,d=parseInt(b.get("current")),e=parseInt(b.get("totalItems")),f=this.pageDefault.size,g=h.values(this.collection.get("size").get())[0],i=parseInt(h.isEmpty(g)?h.values(f)[0]:h.values(g)[0]),j=e%i,k=(e-j)/i+(j>0?1:0),l=this.pageDefault.sizeDefault,m=(l-1)/2;1>d&&(d=1),d>k&&(d=k),b.set({totalPages:k}),c={size:i,pre:1!==d,preDis:!(1!==d),next:d!==k,nextDis:!(d!==k),options:[],totalItems:e,startItem:(d-1)*i+1,endItem:d*i>e?e:d*i,totalPages:k,totalShow:k>l&&k-m>d?!0:!1,ellipsis:k>l&&k-m-1>d?!0:!1,items:[],current:d};for(var n=1,o=k>l?l:k,p=m;o>=n;n++){var q=1;k>l?(d>m&&k-m>=d&&(q=d-p,p--),d>k-m&&(q=k-l+n),m>=d&&(q=n)):q=n,c.items.push({num:q,currentClass:d===q?!0:!1})}if(h.isArray(this.pageDefault.sizeOptions))for(var n=0,r=this.pageDefault.sizeOptions;n<r.length;n++)c.options.push({num:r[n],selected:i===r[n]});return c},error:function(){this.show(!1)},registerEvents:function(){this.sizeSelect&&(this.sizeSelect.onSelect=this.changeSize),f(".mi-paging-goto",this.rootNode).click(this.paginate),f(".mi-paging-item",this.rootNode).click(this.paginate)},render:function(a){if(!h.isEmpty(a)){var b,c=this.rootNode;c.innerHTML=h.parseTpl(this.pageTpl,this.prepareTplConfig(a)),b=f("select[name=size]",this.rootNode),b.length&&(this.sizeSelect=new g({width:58,size:3,zIndex:1}).apply(b[0])),h.removeClass(c,this.hideClass),this.registerEvents()}}}).inherits(k);c.exports=p}),define("fdp/1.0.0/fdp-table",["./fdp-namespace","cellula/0.4.2/cellula","cellula/0.4.2/cellula-namespace","cellula/0.4.2/cellula-class","cellula/0.4.2/cellula-util","cellula/0.4.2/cellula-events","cellula/0.4.2/cellula-cell","cellula/0.4.2/cellula-element","cellula/0.4.2/cellula-collection","$"],function(a,b,c){var d=a("./fdp-namespace"),e=a("cellula/0.4.2/cellula"),f=(a("$"),e._util),g=e.Class,h=(e.Element,e.Cell),i=(e.Collection,d.DataTable=new g("DataTable",{hideClass:"fn-hide",tableTpl:{head:null,body:null},tips:{noResult:null,error:null},tipNodes:{},initTip:function(){for(var a in this.tips)this.tipNodes[a]=this.getNode(this.tips[a])},init:function(a){this._super(a),this.initTip()},registerEvents:function(){},prepareTplConfig:function(){},show:function(a){var b=a?f.removeClass:f.addClass;b(this.rootNode,this.hideClass)},error:function(){this.show(!1),f.removeClass(this.tipNodes.error,this.hideClass)},showNoResult:function(){this.show(!1),f.removeClass(this.tipNodes.noResult,this.hideClass)},receiver:function(a){if(a){var b=(a.target,a.name.split(":")[1]);switch(b){case"TABLERENDER":this.render(arguments[1]);break;case"SYSTEMERROR":this.show(!1)}}},render:function(a){var b=this.rootNode;if(f.addClass(this.tipNodes.error,this.hideClass),f.addClass(this.tipNodes.noResult,this.hideClass),0===a.length)return this.showNoResult(),this.emit("TABLEVIEW:NORESULT"),!1;var c=b.getElementsByTagName("table")[0],d=c.getElementsByTagName("thead")[0],e=c.getElementsByTagName("tbody")[0];d&&c.removeChild(d),e&&c.removeChild(e),a=this.prepareTplConfig(a);var g=document.createElement("div");g.innerHTML="<table><thead>"+f.parseTpl(this.tableTpl.head,a)+"</thead></table>",d=g.getElementsByTagName("thead")[0],c.appendChild(d),g.innerHTML="<table><tbody>"+f.parseTpl(this.tableTpl.body,a)+"</tbody></table>",e=g.getElementsByTagName("tbody")[0],c.appendChild(e),this.show(!0),this.registerEvents()}}).inherits(h));c.exports=i}),define("fdp/1.0.0/fdp",["./fdp-namespace","./fdp-formItem","cellula/0.4.2/cellula","cellula/0.4.2/cellula-namespace","cellula/0.4.2/cellula-class","cellula/0.4.2/cellula-util","cellula/0.4.2/cellula-events","cellula/0.4.2/cellula-cell","cellula/0.4.2/cellula-element","cellula/0.4.2/cellula-collection","$","./fdp-form","./fdp-table","./fdp-paginator","select/1.0.0/select"],function(a,b,c){{var d=a("./fdp-namespace");a("./fdp-formItem"),a("./fdp-form"),a("./fdp-table"),a("./fdp-paginator")}c.exports=d});