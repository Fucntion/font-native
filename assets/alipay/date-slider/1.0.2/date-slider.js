define("alipay/date-slider/1.0.2/date-slider",["$","gallery/moment/1.6.2/moment","alipay/slider/1.1.1/slider","arale/widget/1.0.3/widget","arale/base/1.0.1/base","arale/class/1.0.0/class","arale/events/1.0.0/events","arale/position/1.0.0/position","./date-slider.css","./date-slider.tpl"],function(e,i,s){function d(e,i){var s=i.unix(),d=i.clone().add("years",1).unix(),a=(d-s)*e/720;return i.add("days",Math.round(a/86400))}function a(e,i){var s=i.unix(),d=i.clone().add("years",1).unix(),a=e.unix();return 720*(a-s)/(d-s)}var t=e("$"),l=e("gallery/moment/1.6.2/moment"),n=e("alipay/slider/1.1.1/slider"),r=e("arale/position/1.0.0/position"),o=e("arale/widget/1.0.3/widget"),u=720;e("./date-slider.css");var c=o.extend({maxValue:u,attrs:{template:e("./date-slider.tpl"),endDate:{value:l().sod().format("YYYY-MM-DD"),getter:function(e){return e.length&&-1!==e.indexOf(".")?l(e,"YYYY.MM.DD").add("days",1):l(e).add("days",1)}},value:[0,0]},render:function(){return c.superclass.render.call(this),this._addHandleSeed(),this._showHandleDates(),this},setup:function(){var e=this;this._slider=new n({element:this.element.find(".ui-slider-line"),range:!0,animate:!1,min:0,max:this.maxValue-2,step:.001,allowCross:!0,values:[0,this.maxValue]}),this._slider.on("start",function(e,i){t("#J-slider-handle-date-"+t(i.handle).index(".ui-slider-handle")).css("z-index",10)}).on("stop",function(e,i){t("#J-slider-handle-date-"+t(i.handle).index(".ui-slider-handle")).css("z-index",1)}).on("slide",function(i,s){e._showHandleDate(s.value,t(s.handle).index(".ui-slider-handle"))}).on("change",function(i,s){e._showHandleDate(s.value,t(s.handle).index(".ui-slider-handle")),e.trigger("select",e._selectedDates)})},_setDateScale:function(e){var i,s;this.element.find(".ui-date-slider-scale").each(function(d,a){s="",a=t(a),i=e.month()+d,i=i%12+1,s+='<span class="ui-date-slider-month">'+i+"</span>",s+='<span class="ui-date-slider-line"></span>',1===i&&(s+='<span class="ui-date-slider-year">'+(e.year()+(0===d?0:1))+"</span>",s=s.replace("slider-line","slider-line ui-date-slider-line-long")),a.append(s)});var d=50*((e.date()-1)/e.daysInMonth());this.element.find(".ui-date-slider-scales").css("margin-left",-d),d>0&&this.element.find(".ui-date-slider-scale").eq(0).css("visibility","hidden")},_showHandleDates:function(){for(var e=this._slider.get("values"),i=0;e.length>i;i++)this._showHandleDate(e[i],i)},_showHandleDate:function(e,i){function s(e,i){r.pin({element:l,x:"50%",y:"50%"},{element:n,x:"50%"+(0==e?"-":"+")+i,y:-10});var s=o.element.find("#J-slider-handle-date-"+(0==e?"1":"0"));s[0]&&r.pin({element:s,x:"50%",y:"50%"},{element:n[0==e?"next":"prev"](),x:"50%"+(0==e?"+":"-")+i,y:-10})}if(0===i||1===i){var a,l,n,o=this;this._selectedDates=this._selectedDates||[],this._selectedDates[i]=d(e,this.get("endDate").subtract("years",1)),a=this._selectedDates[i].format("MM.DD"),l=this.element.find("#J-slider-handle-date-"+i),l[0]||(l=t('<span class="ui-slider-handle-date" id="J-slider-handle-date-'+i+'"></span>'),this.element.append(l)),l.html(a),n=this.element.find(".ui-slider-handle").eq(i);var u=parseInt(35-this._slider.values()[1]+this._slider.values()[0],10)/2;0>=u&&(u=0),s(i,u)}},_addHandleSeed:function(){this._slider.handles.eq(0).attr("seed","f-consume-standard-youbiao1"),this._slider.handles.eq(1).attr("seed","f-consume-standard-youbiao2")},_onRenderEndDate:function(e){this._setDateScale(e.subtract("years",1))},_onRenderValue:function(e){for(var i=0;e.length>i;i++)e[i]&&(e[i]=-1!==e[i].indexOf(".")?l(e[i],"YYYY.MM.DD"):l(e[i]),e[i]=e[i].sod(),this._slider.values(i,a(e[i],this.get("endDate").subtract("years",1))))}});c.changeValueToDate=d,c.changeDateToValue=a,s.exports=c}),define("alipay/date-slider/1.0.2/date-slider.css",[],function(){seajs.importStyle(".ui-date-slider,.ui-date-slider *{margin:0;padding:0;-webkit-text-size-adjust:none}.ui-date-slider{width:650px;position:relative;zoom:1}.ui-slider{height:3px;background:#eee;width:600px;border-top:1px solid #BBB;border-left:1px solid #BBB;border-bottom:1px solid #fff;border-radius:2px;position:absolute;z-index:1;top:35px;left:25px}.ui-slider:after{clear:both;content:\" \";display:block;font-size:0;height:0;visibility:hidden}.ui-slider-range{background-color:#8BC7F0;border:1px solid #7DA9DC;height:3px;position:absolute;z-index:1;top:-1px;zoom:1;overflow:hidden}.ui-slider-range:after{content:'';position:absolute;height:1px;background-color:#B7E1FF;top:0;left:0;width:100%}.ui-slider-handle{position:absolute;height:15px;width:10px;background:url(https://i.alipayobjects.com/e/201211/1dh1jloUCL.png) no-repeat;cursor:pointer;z-index:2;top:-6px;margin-left:-5px}.ui-slider-handle:hover,.ui-state-focus{background-position:-10px 0}.ui-slider-handle-date{position:absolute;color:#fff;background-color:#96D1F9;font-size:10px;line-height:1;padding:2px 3px;border-radius:2px;border:1px solid #62A3E8}.ui-slider-handle-date-active{border:1px solid #62A3E8}.ui-date-slider-scales{overflow:hidden;position:relative;zoom:1}.ui-date-slider-scale{width:50px;float:left;height:60px;text-align:center;position:relative}.ui-date-slider-line{height:4px;border-left:1px solid #aaa;width:0;position:absolute;top:32px;left:25px;overflow:hidden}.ui-date-slider-line-long{height:14px;top:22px}.ui-date-slider-month{color:#aaa;font-size:10px;position:absolute;bottom:3px;left:15px;width:20px}.ui-date-slider-year{color:#aaa;font-size:10px;position:absolute;top:6px;left:15px;width:20px}")}),define("alipay/date-slider/1.0.2/date-slider.tpl",[],'<div class="ui-date-slider">\n    <div class="ui-slider-line" seed="f-consume-standard-shijianzhou"></div>\n    <div class="ui-date-slider-scales">\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n        <div class="ui-date-slider-scale"></div>\n    </div>\n</div>\n');
