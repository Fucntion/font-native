define("cellula/0.4.2/cellula-events",["./cellula-namespace"],function(a,b,c){function d(a){return a&&k.test(a.__cid__)}function e(){function a(a,b){return{func:a,context:b,next:null}}function b(a){return{head:a,tail:a,push:function(a){return this.head?(this.tail.next=a)&&(this.tail=a):(this.head=a)&&(this.tail=a),this}}}this.__cid__=i+"Events"+j+ ++h;var c={},e={},f={},k={};this._check=d,this._apis={},this._getMapping=function(){return g.copy(c)},this.getFollowers=function(){return g.copy(e)},this._getApiList=function(){return g.copy(f)},this.follow=function(a,b){return d(a)?b?void a.register(b,this):a.register(this):"Not Support!"},this.unfollow=function(a,b){return d(a)?b?void a.cancel(b,this):a.cancel(this):"Not Support!"},this.register=function(a,b,f){return d(a)?e[a.__cid__]=a:d(b)?(g.isString(a)&&(a=[a]),void(g.isArray(a)&&g.each(a,function(a){var d=c[a]=c[a]||[];if(d.push(b),f&&0==f.multiple){var e,g=d.length;for(e=0;g-1>e;e++)if(d[e]===b){d.pop();break}}}))):"Not Support!"},this.cancel=function(a,b){if(d(a))return delete e[a.__cid__];if(!a)return c={};if(!b&&(g.isString(a)&&(a=[a]),g.isArray(a)))return g.each(a,function(a){delete c[a]});if(g.isString(a)&&(a=[a]),g.isArray(a)){var f,h,i,j;g.each(a,function(a){for(j=c[a],i=[],h=0,f=j.length;f>h;h++)j[h]!==b&&i.push(j[h]);c[a]=i})}},this.emit=function(a){var b,d,f,h,i,j=g.slice.call(arguments,1,arguments.length);if(a||(a=g.keys(c)),g.isString(a)&&(a=[a]),g.isArray(a))for(;h=a.shift();){if(i={target:this,name:h},d=g.copy(e),f=g.copy(c[h]))for(;b=f.shift();)b.receiver.apply(b,[i].concat(j)),delete d[b.__cid__];g.each(d,function(a){a.receiver.apply(a,[i].concat(j))})}},this.receiver=function(){},this.registerApi=function(c,d,e){return d?e&&!g.isString(e)?g.warn("invalid parameter!"):(g.isArray(c)||(c=[c]),void g.each(c,function(c){if(!g.isString(c))return g.warn("invalid parameter!");var h=e?[c,e]:[c],i=d._apis[c],j=d.__cid__;g.isString(i)&&(i=d[c]),g.isFunction(i)?g.each(h,function(c){k[j]=k[j]||{},k[j][c]=c;var e=a(i,d);f[c]?f[c].push(e):f[c]=b(e)}):g.warn("the "+c+" method does not exist in context's api list!")},this)):g.warn("invalid parameter!")},this.applyApi=function(a){if(!a||!g.isString(a))return g.warn("invalid parameter!");var b,c=[],d=":",e=a.split(d),h=e[0],i=e[1],j=f[h],k=g.slice.call(arguments,1);if(j)for(b=j.head;b;)i?(b.context.__cid__.indexOf(i)>-1&&c.push(b.func.apply(b.context,k)),b=b.next):c.push(b.func.apply(b.context,k))&&(b=b.next);return c},this.removeApi=function(a,b){function c(a,b){g.each(a,function(a){if(f[a]){var c,d;for(c=d=f[a].head;c;)c.context==b?c==d?f[a].head=d=c.next:d.next=c.next:d=c,c=c.next}})}return a?(g.isArray(a)||(a=[a]),"all"===a[0]?f={}:d(a[0])?c(k[a[0].__cid__],a[0]):void(b?c(a,b):g.each(a,function(a){delete f[a]}))):g.warn("invalid parameter!")}}var f=a("./cellula-namespace"),g=f._util,h=0,i="cellula_",j="_instance_",k=new RegExp("^"+i+".*"+j+"\\d+$");f.Events=e,c.exports=e});